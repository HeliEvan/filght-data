<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ•°æ®è¡¥å½• - é£è¡Œç»å†å½•å…¥ç³»ç»Ÿ</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Microsoft YaHei', 'PingFang SC', Arial, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
            writing-mode: horizontal-tb;
            direction: ltr;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            padding: 40px;
        }
        
        .header {
            text-align: center;
            margin-bottom: 30px;
        }
        
        h1 {
            color: #333;
            font-size: 2em;
            margin-bottom: 10px;
        }
        
        .back-link {
            color: #667eea;
            text-decoration: none;
            font-size: 0.9em;
            display: inline-block;
            margin-bottom: 20px;
        }
        
        .back-link:hover {
            text-decoration: underline;
        }
        
        .form-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 20px;
            margin-bottom: 20px;
            align-items: start;
        }
        
        @media (max-width: 1200px) {
            .form-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }
        
        @media (max-width: 768px) {
            .form-grid {
                grid-template-columns: 1fr;
            }
        }
        
        .form-group {
            display: flex;
            flex-direction: column;
            min-height: 80px;
        }
        
        .form-group.full-width {
            grid-column: 1 / -1;
        }
        
        label {
            color: #333;
            font-weight: 600;
            margin-bottom: 8px;
            font-size: 0.95em;
            height: 24px;
            display: flex;
            align-items: center;
        }
        
        input, select, textarea {
            padding: 12px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-size: 1em;
            font-family: inherit;
            transition: border-color 0.3s;
            width: 100%;
            box-sizing: border-box;
            height: 44px;
        }
        
        input:focus, select:focus, textarea:focus {
            outline: none;
            border-color: #667eea;
        }
        
        textarea {
            resize: vertical;
            min-height: 100px;
            height: auto;
        }
        
        .time-group {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
        }
        
        .time-group label {
            height: auto;
            margin-bottom: 5px;
        }
        
        .time-group input {
            height: 44px;
        }
        
        .button-group {
            display: flex;
            gap: 15px;
            justify-content: center;
            margin-top: 30px;
        }
        
        button {
            padding: 15px 40px;
            border: none;
            border-radius: 8px;
            font-size: 1.1em;
            font-weight: 600;
            cursor: pointer;
            transition: transform 0.2s, box-shadow 0.2s;
        }
        
        .btn-primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }
        
        .btn-secondary {
            background: #f0f0f0;
            color: #333;
        }
        
        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
        }
        
        .info-tip {
            background: #fff3cd;
            padding: 8px 10px;
            border-radius: 8px;
            margin-top: 5px;
            font-size: 0.85em;
            color: #856404;
            min-height: 32px;
            display: flex;
            align-items: center;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <a href="index.html" class="back-link">â† è¿”å›é¦–é¡µ</a>
            <h1>ğŸ“ é£è¡Œæ•°æ®è¡¥å½•</h1>
            <p style="color: #666; margin-top: 10px;">ç”¨äºè¡¥å½•å†å²é£è¡Œæ•°æ®ï¼Œæ—¶é—´æ ¼å¼æ”¯æŒè¶…è¿‡24å°æ—¶ï¼ˆæœ€å¤š10000:60ï¼‰</p>
        </div>
        
        <form id="supplementForm">
            <div class="form-grid">
                <div class="form-group">
                    <label for="year">å¹´ä»½ *</label>
                    <input type="number" id="year" name="year" min="1900" max="2100" required placeholder="å¦‚ï¼š2024">
                </div>
                
                <div class="form-group">
                    <label for="aircraftType">èˆªç©ºå™¨å‹å· *</label>
                    <input type="text" id="aircraftType" name="aircraftType" required placeholder="æ‰‹åŠ¨è¾“å…¥èˆªç©ºå™¨å‹å·">
                </div>
                
                <div class="form-group">
                    <label for="totalTime">æ€»æ—¶é—´ (HH:MM) *</label>
                    <input type="text" id="totalTime" name="totalTime" pattern="[0-9]{1,5}:[0-5][0-9]" placeholder="å¦‚ï¼š100:30" required>
                    <div class="info-tip">æ”¯æŒè¶…è¿‡24å°æ—¶ï¼Œæœ€å¤š10000:60</div>
                </div>
                
                <div class="form-group">
                    <label for="captainTime">æœºé•¿æ—¶é—´ (HH:MM)</label>
                    <input type="text" id="captainTime" name="captainTime" pattern="[0-9]{1,5}:[0-5][0-9]" placeholder="å¦‚ï¼š100:30">
                </div>
                
                <div class="form-group">
                    <label for="copilotTime">å‰¯é©¾é©¶æ—¶é—´ (HH:MM)</label>
                    <input type="text" id="copilotTime" name="copilotTime" pattern="[0-9]{1,5}:[0-5][0-9]" placeholder="å¦‚ï¼š100:30">
                </div>
                
                <div class="form-group">
                    <label for="spic">SPIC (HH:MM)</label>
                    <input type="text" id="spic" name="spic" pattern="[0-9]{1,5}:[0-5][0-9]" placeholder="å¦‚ï¼š100:30">
                </div>
                
                <div class="form-group">
                    <label for="captainCrossCountry">æœºé•¿è½¬åœº (HH:MM)</label>
                    <input type="text" id="captainCrossCountry" name="captainCrossCountry" pattern="[0-9]{1,5}:[0-5][0-9]" placeholder="å¦‚ï¼š100:30">
                </div>
                
                <div class="form-group">
                    <label for="copilotCrossCountry">å‰¯é©¾é©¶è½¬åœº (HH:MM)</label>
                    <input type="text" id="copilotCrossCountry" name="copilotCrossCountry" pattern="[0-9]{1,5}:[0-5][0-9]" placeholder="å¦‚ï¼š100:30">
                </div>
                
                <div class="form-group">
                    <label for="instructor">å¸¦é£ (HH:MM)</label>
                    <input type="text" id="instructor" name="instructor" pattern="[0-9]{1,5}:[0-5][0-9]" placeholder="å¦‚ï¼š100:30">
                </div>
                
                <div class="form-group">
                    <label for="instructorCrossCountry">å¸¦é£è½¬åœº (HH:MM)</label>
                    <input type="text" id="instructorCrossCountry" name="instructorCrossCountry" pattern="[0-9]{1,5}:[0-5][0-9]" placeholder="å¦‚ï¼š100:30">
                </div>
                
                <div class="form-group">
                    <label for="instrument">ä»ªè¡¨ (HH:MM)</label>
                    <input type="text" id="instrument" name="instrument" pattern="[0-9]{1,5}:[0-5][0-9]" placeholder="å¦‚ï¼š100:30">
                </div>
                
                <div class="form-group">
                    <label for="nightFlight">å¤œèˆª (HH:MM)</label>
                    <input type="text" id="nightFlight" name="nightFlight" pattern="[0-9]{1,5}:[0-5][0-9]" placeholder="å¦‚ï¼š100:30">
                </div>
                
                <div class="form-group">
                    <label>ç€é™†æ¬¡æ•°</label>
                    <div class="time-group">
                        <div>
                            <label for="landingsDay" style="font-size: 0.85em; color: #666;">æ˜¼é—´</label>
                            <input type="number" id="landingsDay" name="landingsDay" min="0" value="0">
                        </div>
                        <div>
                            <label for="landingsNight" style="font-size: 0.85em; color: #666;">å¤œé—´</label>
                            <input type="number" id="landingsNight" name="landingsNight" min="0" value="0">
                        </div>
                    </div>
                </div>
                
                <div class="form-group">
                    <label for="captain">æœºé•¿</label>
                    <input type="text" id="captain" name="captain" placeholder="è¾“å…¥æœºé•¿å§“å">
                </div>
                
                <div class="form-group">
                    <label for="copilot">å‰¯é©¾é©¶</label>
                    <input type="text" id="copilot" name="copilot" placeholder="è¾“å…¥å‰¯é©¾é©¶å§“å">
                </div>
                
                <div class="form-group">
                    <label for="rescued">æ•‘åŠ©äººæ•°</label>
                    <input type="number" id="rescued" name="rescued" min="0" value="0">
                </div>
                
                <div class="form-group full-width">
                    <label for="remarks">å¤‡æ³¨</label>
                    <textarea id="remarks" name="remarks" placeholder="å…¶ä»–éœ€è¦è®°å½•çš„ä¿¡æ¯"></textarea>
                </div>
            </div>
            
            <div class="button-group">
                <button type="submit" class="btn-primary">ä¿å­˜è¡¥å½•æ•°æ®</button>
                <button type="reset" class="btn-secondary">é‡ç½®è¡¨å•</button>
            </div>
        </form>
    </div>
    
    <script>
        // æ—¶é—´è¾“å…¥æ ¼å¼åŒ–ï¼ˆæ”¯æŒè¶…è¿‡24å°æ—¶ï¼‰
        function setupTimeInputFormat() {
            const timeInputs = ['totalTime', 'captainTime', 'copilotTime', 'spic', 
                              'captainCrossCountry', 'copilotCrossCountry', 
                              'instructor', 'instructorCrossCountry', 
                              'instrument', 'nightFlight'];
            
            timeInputs.forEach(inputId => {
                const input = document.getElementById(inputId);
                if (!input) return;
                
                // åªå…è®¸è¾“å…¥æ•°å­—å’Œå†’å·
                input.addEventListener('keypress', function(e) {
                    const char = String.fromCharCode(e.which);
                    if (!/[0-9]/.test(char) && char !== ':') {
                        e.preventDefault();
                    }
                });
                
                // å¤„ç†è¾“å…¥ï¼Œè‡ªåŠ¨æ·»åŠ å†’å·
                input.addEventListener('input', function(e) {
                    let value = e.target.value.replace(/[^0-9:]/g, '');
                    
                    // å¦‚æœè¾“å…¥äº†æ•°å­—ä¸”æ²¡æœ‰å†’å·ï¼Œåœ¨é€‚å½“ä½ç½®æ·»åŠ å†’å·
                    if (value.length > 0 && !value.includes(':')) {
                        // å…è®¸æœ€å¤š5ä½æ•°å­—çš„å°æ—¶éƒ¨åˆ†
                        if (value.length <= 5) {
                            // ä¸è‡ªåŠ¨æ·»åŠ å†’å·ï¼Œè®©ç”¨æˆ·æ‰‹åŠ¨è¾“å…¥
                        } else {
                            // å¦‚æœè¶…è¿‡5ä½ï¼Œè‡ªåŠ¨åœ¨å€’æ•°ç¬¬2ä½å‰æ·»åŠ å†’å·
                            value = value.substring(0, value.length - 2) + ':' + value.substring(value.length - 2);
                            e.target.value = value;
                        }
                    }
                    // å¦‚æœå·²ç»æœ‰å†’å·ï¼ŒéªŒè¯æ ¼å¼
                    else if (value.includes(':')) {
                        const parts = value.split(':');
                        // å°æ—¶éƒ¨åˆ†æœ€å¤š5ä½
                        if (parts[0].length > 5) {
                            parts[0] = parts[0].substring(0, 5);
                        }
                        // åˆ†é’Ÿéƒ¨åˆ†æœ€å¤š2ä½ï¼Œä¸”ä¸è¶…è¿‡59
                        if (parts[1] && parts[1].length > 2) {
                            parts[1] = parts[1].substring(0, 2);
                        }
                        if (parts[1] && parseInt(parts[1]) > 59) {
                            parts[1] = '59';
                        }
                        value = parts.join(':');
                        e.target.value = value;
                    }
                });
                
                // éªŒè¯æ ¼å¼
                input.addEventListener('blur', function(e) {
                    const value = e.target.value;
                    if (value && !/^[0-9]{1,5}:[0-5][0-9]$/.test(value)) {
                        // å¦‚æœæ ¼å¼ä¸æ­£ç¡®ï¼Œå°è¯•ä¿®å¤
                        const parts = value.split(':');
                        if (parts.length === 2) {
                            let h = parts[0].padStart(1, '0');
                            if (h.length > 5) h = h.substring(0, 5);
                            const hour = parseInt(h) || 0;
                            const minute = Math.min(59, parseInt(parts[1]) || 0);
                            e.target.value = `${hour}:${String(minute).padStart(2, '0')}`;
                        }
                    }
                    // éªŒè¯æœ€å¤§å€¼
                    if (value) {
                        const parts = value.split(':');
                        const hour = parseInt(parts[0]) || 0;
                        const minute = parseInt(parts[1]) || 0;
                        if (hour > 10000 || (hour === 10000 && minute > 60)) {
                            e.target.value = '10000:60';
                        }
                    }
                });
            });
        }
        
        setupTimeInputFormat();
        
        // è¡¨å•æäº¤
        document.getElementById('supplementForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const formData = new FormData(e.target);
            const year = formData.get('year');
            
            // åˆ›å»ºè¡¥å½•è®°å½•ï¼ˆä½¿ç”¨å¹´ä»½çš„ç¬¬ä¸€å¤©ä½œä¸ºæ—¥æœŸï¼‰
            const record = {
                id: Date.now(),
                date: `${year}-01-01`, // ä½¿ç”¨å¹´ä»½çš„ç¬¬ä¸€å¤©
                aircraftType: formData.get('aircraftType'),
                aircraftReg: '', // è¡¥å½•æ•°æ®å¯èƒ½æ²¡æœ‰ç™»è®°å·
                departure: '', // è¡¥å½•æ•°æ®å¯èƒ½æ²¡æœ‰èµ·é™ç«™
                arrival: '',
                engineStart: '',
                engineStop: '',
                totalTime: formData.get('totalTime') || '00:00',
                captain: formData.get('captain') || '',
                captainTime: formData.get('captainTime') || '00:00',
                captainCrossCountry: formData.get('captainCrossCountry') || '00:00',
                copilot: formData.get('copilot') || '',
                copilotTime: formData.get('copilotTime') || '00:00',
                copilotCrossCountry: formData.get('copilotCrossCountry') || '00:00',
                spic: formData.get('spic') || '00:00',
                instructor: formData.get('instructor') || '00:00',
                instructorCrossCountry: formData.get('instructorCrossCountry') || '00:00',
                instrument: formData.get('instrument') || '00:00',
                nightFlight: formData.get('nightFlight') || '00:00',
                flightType: 'è¡¥å½•',
                landingsDay: parseInt(formData.get('landingsDay')) || 0,
                landingsNight: parseInt(formData.get('landingsNight')) || 0,
                crewMembers: '',
                rescued: parseInt(formData.get('rescued')) || 0,
                remarks: formData.get('remarks') || ''
            };
            
            // ä¿å­˜åˆ°localStorage
            const records = JSON.parse(localStorage.getItem('flightRecords') || '[]');
            records.push(record);
            localStorage.setItem('flightRecords', JSON.stringify(records));
            
            alert('è¡¥å½•æ•°æ®ä¿å­˜æˆåŠŸï¼');
            e.target.reset();
        });
    </script>
</body>
</html>
