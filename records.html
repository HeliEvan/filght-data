<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æŸ¥çœ‹é£è¡Œè®°å½• - é£è¡Œç»å†å½•å…¥ç³»ç»Ÿ</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Microsoft YaHei', 'PingFang SC', Arial, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
            writing-mode: horizontal-tb;
            direction: ltr;
            text-orientation: mixed;
        }
        
        * {
            writing-mode: horizontal-tb;
            direction: ltr;
            text-orientation: mixed;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            padding: 40px;
            writing-mode: horizontal-tb;
            direction: ltr;
        }
        
        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
            flex-wrap: wrap;
            gap: 15px;
            writing-mode: horizontal-tb;
            direction: ltr;
        }
        
        h1 {
            color: #333;
            font-size: 2em;
            writing-mode: horizontal-tb;
            direction: ltr;
        }
        
        .back-link {
            color: #667eea;
            text-decoration: none;
            font-size: 0.9em;
            writing-mode: horizontal-tb;
            direction: ltr;
        }
        
        .back-link:hover {
            text-decoration: underline;
        }
        
        .controls {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
            margin-bottom: 20px;
            writing-mode: horizontal-tb;
            direction: ltr;
        }
        
        .controls input, .controls select {
            padding: 10px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-size: 0.95em;
            writing-mode: horizontal-tb;
            direction: ltr;
        }
        
        .controls input:focus, .controls select:focus {
            outline: none;
            border-color: #667eea;
        }
        
        .btn {
            padding: 10px 20px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 0.95em;
            font-weight: 600;
            transition: transform 0.2s;
        }
        
        .btn:hover {
            transform: translateY(-2px);
        }
        
        .btn-primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }
        
        .btn-danger {
            background: #f5576c;
            color: white;
        }
        
        .table-container {
            overflow-x: auto;
            margin-top: 20px;
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
            background: white;
            writing-mode: horizontal-tb;
            direction: ltr;
            text-orientation: mixed;
        }
        
        th {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 15px 10px;
            text-align: left;
            font-weight: 600;
            position: sticky;
            top: 0;
            z-index: 10;
            writing-mode: horizontal-tb;
            direction: ltr;
            text-orientation: mixed;
            white-space: nowrap;
        }
        
        td {
            padding: 12px 10px;
            border-bottom: 1px solid #e0e0e0;
            writing-mode: horizontal-tb;
            direction: ltr;
            text-orientation: mixed;
            white-space: nowrap;
        }
        
        tr:hover {
            background: #f5f5f5;
        }
        
        .badge {
            display: inline-block;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 0.85em;
            font-weight: 600;
            writing-mode: horizontal-tb;
            direction: ltr;
        }
        
        .badge-yes {
            background: #4caf50;
            color: white;
        }
        
        .badge-no {
            background: #e0e0e0;
            color: #666;
        }
        
        .no-records {
            text-align: center;
            padding: 60px 20px;
            color: #999;
            writing-mode: horizontal-tb;
            direction: ltr;
        }
        
        .no-records-icon {
            font-size: 4em;
            margin-bottom: 20px;
        }
        
        .action-buttons {
            display: flex;
            gap: 5px;
            writing-mode: horizontal-tb;
            direction: ltr;
        }
        
        .btn-small {
            padding: 5px 10px;
            font-size: 0.85em;
            writing-mode: horizontal-tb;
            direction: ltr;
        }
        
        .btn {
            writing-mode: horizontal-tb;
            direction: ltr;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <div>
                <a href="index.html" class="back-link">â† è¿”å›é¦–é¡µ</a>
                <h1>ğŸ“‹ æŸ¥çœ‹é£è¡Œè®°å½•</h1>
            </div>
        </div>
        
        <div class="controls">
            <select id="nameFilter">
                <option value="">æ‰€æœ‰äººå‘˜</option>
            </select>
            <input type="date" id="dateFrom" placeholder="å¼€å§‹æ—¥æœŸ">
            <input type="date" id="dateTo" placeholder="ç»“æŸæ—¥æœŸ">
            <select id="flightTypeFilter">
                <option value="">æ‰€æœ‰é£è¡Œç§ç±»</option>
                <option value="è®­ç»ƒ">è®­ç»ƒ</option>
                <option value="è½¬åœº">è½¬åœº</option>
                <option value="æµ·ä¸Šè®­ç»ƒ">æµ·ä¸Šè®­ç»ƒ</option>
                <option value="æ•‘åŠ©">æ•‘åŠ©</option>
                <option value="å…¶ä»–">å…¶ä»–</option>
            </select>
            <button class="btn btn-primary" onclick="filterRecords()">ç­›é€‰</button>
            <button class="btn btn-primary" onclick="resetFilter()">é‡ç½®</button>
        </div>
        
        <div class="table-container">
            <table id="recordsTable">
                <thead>
                    <tr>
                        <th>æ—¥æœŸ</th>
                        <th>èˆªç©ºå™¨å‹å·</th>
                        <th>èˆªç©ºå™¨ç™»è®°å·</th>
                        <th>èµ·é£ç«™</th>
                        <th>é™è½ç«™</th>
                        <th>å¼€è½¦æ—¶åˆ»</th>
                        <th>å…³è½¦æ—¶åˆ»</th>
                        <th>æ€»æ—¶é—´</th>
                        <th>æœºé•¿æ—¶é—´</th>
                        <th>å‰¯é©¾é©¶æ—¶é—´</th>
                        <th>SPIC</th>
                        <th>æœºé•¿è½¬åœº</th>
                        <th>å‰¯é©¾é©¶è½¬åœº</th>
                        <th>å¸¦é£</th>
                        <th>å¸¦é£è½¬åœº</th>
                        <th>ä»ªè¡¨</th>
                        <th>å¤œèˆª</th>
                        <th>é£è¡Œç§ç±»</th>
                        <th>ç€é™†æ¬¡æ•°(æ˜¼é—´)</th>
                        <th>ç€é™†æ¬¡æ•°(å¤œé—´)</th>
                        <th>æœºé•¿</th>
                        <th>å‰¯é©¾é©¶</th>
                        <th>æ•‘åŠ©äººæ•°</th>
                        <th>å¤‡æ³¨</th>
                        <th>æ“ä½œ</th>
                    </tr>
                </thead>
                <tbody id="recordsBody">
                </tbody>
            </table>
        </div>
        
        <div id="noRecords" class="no-records" style="display: none;">
            <div class="no-records-icon">âœˆï¸</div>
            <p>æš‚æ— é£è¡Œè®°å½•</p>
        </div>
    </div>
    
    <script>
        let allRecords = [];
        
        function loadRecords() {
            allRecords = JSON.parse(localStorage.getItem('flightRecords') || '[]');
            // æŒ‰æ—¥æœŸå€’åºæ’åˆ—
            allRecords.sort((a, b) => new Date(b.date) - new Date(a.date));
            loadPersonList();
            displayRecords(allRecords);
        }
        
        function displayRecords(records) {
            const tbody = document.getElementById('recordsBody');
            const noRecords = document.getElementById('noRecords');
            
            if (records.length === 0) {
                tbody.innerHTML = '';
                noRecords.style.display = 'block';
                return;
            }
            
            noRecords.style.display = 'none';
            tbody.innerHTML = records.map(record => `
                <tr>
                    <td>${record.date}</td>
                    <td>${record.aircraftType}</td>
                    <td>${record.aircraftReg}</td>
                    <td>${record.departure}</td>
                    <td>${record.arrival}</td>
                    <td>${record.engineStart || '-'}</td>
                    <td>${record.engineStop || '-'}</td>
                    <td><strong>${record.totalTime}</strong></td>
                    <td>${record.captainTime || '00:00'}</td>
                    <td>${record.copilotTime || '00:00'}</td>
                    <td>${record.spic || '00:00'}</td>
                    <td>${record.captainCrossCountry || '00:00'}</td>
                    <td>${record.copilotCrossCountry || '00:00'}</td>
                    <td>${record.instructor || '00:00'}</td>
                    <td>${record.instructorCrossCountry || '00:00'}</td>
                    <td>${record.instrument && record.instrument !== '00:00' ? record.instrument : '-'}</td>
                    <td>${record.nightFlight && record.nightFlight !== '00:00' ? record.nightFlight : '-'}</td>
                    <td>${record.flightType}</td>
                    <td>${record.landingsDay || 0}</td>
                    <td>${record.landingsNight || 0}</td>
                    <td>${record.captain || '-'}</td>
                    <td>${record.copilot || '-'}</td>
                    <td>${record.rescued || 0}</td>
                    <td>${record.remarks || '-'}</td>
                    <td>
                        <div class="action-buttons">
                            <button class="btn btn-primary btn-small" onclick="editRecord(${record.id})" style="background: #4facfe;">ä¿®æ”¹</button>
                            <button class="btn btn-danger btn-small" onclick="deleteRecord(${record.id})">åˆ é™¤</button>
                        </div>
                    </td>
                </tr>
            `).join('');
        }
        
        function loadPersonList() {
            const personSet = new Set();
            allRecords.forEach(record => {
                if (record.captain) personSet.add(record.captain);
                if (record.copilot) personSet.add(record.copilot);
            });
            
            const nameSelect = document.getElementById('nameFilter');
            const currentValue = nameSelect.value;
            
            nameSelect.innerHTML = '<option value="">æ‰€æœ‰äººå‘˜</option>';
            Array.from(personSet).sort().forEach(name => {
                const option = document.createElement('option');
                option.value = name;
                option.textContent = name;
                nameSelect.appendChild(option);
            });
            
            if (currentValue) {
                nameSelect.value = currentValue;
            }
        }
        
        function filterRecords() {
            const personName = document.getElementById('nameFilter').value;
            const dateFrom = document.getElementById('dateFrom').value;
            const dateTo = document.getElementById('dateTo').value;
            const flightType = document.getElementById('flightTypeFilter').value;
            
            let filtered = allRecords.filter(record => {
                const matchName = !personName || 
                    record.captain === personName || 
                    record.copilot === personName;
                
                const matchDate = (!dateFrom || record.date >= dateFrom) && 
                                 (!dateTo || record.date <= dateTo);
                
                const matchType = !flightType || record.flightType === flightType;
                
                return matchName && matchDate && matchType;
            });
            
            displayRecords(filtered);
        }
        
        function resetFilter() {
            document.getElementById('nameFilter').value = '';
            document.getElementById('dateFrom').value = '';
            document.getElementById('dateTo').value = '';
            document.getElementById('flightTypeFilter').value = '';
            displayRecords(allRecords);
        }
        
        function deleteRecord(id) {
            if (confirm('ç¡®å®šè¦åˆ é™¤è¿™æ¡è®°å½•å—ï¼Ÿ')) {
                allRecords = allRecords.filter(r => r.id !== id);
                localStorage.setItem('flightRecords', JSON.stringify(allRecords));
                loadRecords();
            }
        }
        
        function editRecord(id) {
            // ä¿å­˜è¦ç¼–è¾‘çš„è®°å½•IDåˆ°sessionStorage
            sessionStorage.setItem('editRecordId', id);
            // è·³è½¬åˆ°å½•å…¥é¡µé¢
            window.location.href = 'input.html';
        }
        
        loadRecords();
    </script>
</body>
</html>
